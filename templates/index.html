<!DOCTYPE html>
<html lang="{{ current_locale or 'uk' }}" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{ _("Portfolio") }} – {{ name }}</title>

    <link rel="stylesheet" href="https://unpkg.com/@picocss/pico@latest/css/pico.min.css"/>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}"/>

    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
    <link href="https://fonts.googleapis.com/css2?family=Michroma&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Honk&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Kalnia+Glaze:wght@100..700&display=swap" rel="stylesheet"/>

    <link rel="icon" href="/static/favicon.ico"/>
    <link rel="apple-touch-icon" href="/static/icon-180.png"/>
    <link rel="manifest" href="/static/site.webmanifest"/>
  </head>
  <body>
    <header class="container sticky-bar">
      <div class="desktop">
        <nav aria-label="Primary">
          <ul class="nav-left">
            <li><a href="#present" data-nav>{{ _("Profile") }}</a></li>
            <li><a href="#projects" data-nav>{{ _("My projects") }}</a></li>
            <li><a href="#contact" data-nav>{{ _("Contacts") }}</a></li>
          </ul>
          <ul class="nav-right">
            <li class="lang-switch">
              <button class="lang-btn contrast outline" type="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language">
                <span class="lang-current">EN</span> ▾
              </button>
              <ul class="lang-menu" role="menu" aria-label="Languages">
                <li role="none"><a role="menuitem" data-lang="uk">{{ _("Ukrainian") }}</a></li>
                <li role="none"><a role="menuitem" data-lang="cs">{{ _("Czech") }}</a></li>
                <li role="none"><a role="menuitem" data-lang="en">{{ _("English") }}</a></li>
              </ul>
            </li>
            <li>
              <button id="themeToggle" class="contrast outline" type="button" aria-label="{{ _('Toggle theme') }}">🌙/☀️</button>
            </li>
          </ul>
        </nav>
      </div>

      <div class="mobile">
        <nav aria-label="Primary">
          <ul>
            <li>
              <details class="dropdown">
                <summary>{{ _("Menu") }}</summary>
                <ul>
                  <li><a href="#present" data-nav>{{ _("Profile") }}</a></li>
                  <li><a href="#projects" data-nav>{{ _("My projects") }}</a></li>
                  <li><a href="#contact" data-nav>{{ _("Contacts") }}</a></li>
                </ul>
              </details>
            </li>
          </ul>
          <ul>
            <li>
              <button id="themeToggle" class="contrast outline" type="button" aria-label="{{ _('Toggle theme') }}">🌙/☀️</button>
            </li>
            <li class="lang-switch">
              <button class="lang-btn contrast outline" type="button" aria-haspopup="true" aria-expanded="false" aria-label="Change language">
                <span class="lang-current">EN</span> ▾
              </button>
              <ul class="lang-menu" role="menu" aria-label="Languages">
                <li role="none"><a role="menuitem" data-lang="uk">{{ _("Українська") }}</a></li>
                <li role="none"><a role="menuitem" data-lang="cs">{{ _("Čeština") }}</a></li>
                <li role="none"><a role="menuitem" data-lang="en">{{ _("English") }}</a></li>
              </ul>
            </li>
          </ul>
        </nav>
      </div>
    </header>

    <main id="main" class="container">
      <!-- HERO / PRESENT -->
      <section id="present" class="panel hero fullvh" aria-labelledby="present-title">
        <div class="hero-inner">
          <h1 id="present-title" class="hello">{{ name }}</h1>

          <img class="avatar" src="{{ url_for('static', filename='avatar2.png') }}" alt="{{ _('%(name)s avatar', name=name) }}"/>

          <h3>{{ _("Hi, my name is %(name)s", name=name) }}</h3>

          <p class="myinfo">
            {%- trans trimmed -%}
            I’m a Prague-based Computer Science graduate 🎓 building lean web apps and prototypes: Python on the backend 👨‍💻 (Flask/Django), HTML/CSS/JS on the frontend, and a growing toolkit of automation and data utilities 🤖📊. I care about readable code, small iterations, and design that stays out of the way ✨. Lately I’ve been exploring applied AI—classification, embeddings, and tiny agents that reduce repetitive work—and sharing lightweight write-ups so others can build on top of my findings.
            {%- endtrans -%}
          </p>

          <p>
            {%- trans trimmed -%}
            Beyond tech, I’m into fishing, long walks with podcasts 🎧, and the occasional street photography 📷. I’m happiest when a simple script unlocks real-world value for someone.
            {%- endtrans -%}
          </p>

          <p>
            <strong>{{ _("Thanks for stopping by.") }}</strong>
            {{ _("Let’s build something useful together.") }} ⚡🌟
          </p>

          <div class="cta">
            <a href="#projects" role="button">{{ _("View projects") }}</a>
            <a href="#contact" class="secondary" role="button">{{ _("Contact") }}</a>
          </div>
        </div>
      </section>

      <!-- PROJECTS -->
      <section id="projects" class="panel fullvh" aria-labelledby="projects-title">
        <h2 id="projects-title">{{ _("My projects") }}</h2>

        <p class="tagline">
          {%- trans trimmed -%}
          Python / Flask / Django · CRM mini-projects · Simple and practical web tools · AI-curious
          {%- endtrans -%}
        </p>

        <ul>
          <li>
            <a href="https://lamik.pythonanywhere.com" target="_blank" rel="noopener">
              <img class="fish" src="{{ url_for('static', filename='fishman.png') }}" alt="{{ _('%(name)s avatar', name=name) }}"/>
            </a>
          </li>
          <li>
            <a href="https://lamik.pythonanywhere.com" target="_blank" rel="noopener noreferrer">
              {{ _("Fishlog (Django) – demo") }}
            </a>
          </li>
          <li>{{ _("CRM Mini (Flask) – demo/description") }}</li>
          <li>
            <a href="https://mykolaprague.github.io/curlytom.github.io/index.html" target="_blank" rel="noopener noreferrer">
              {{ _("Simple Web") }}
            </a>
          </li>
        </ul>
      </section>

      <!-- CONTACT -->
      <section id="contact" class="panel fullvh" aria-labelledby="contact-title">
        <h2 id="contact-title">{{ _("Contacts") }}</h2>

        <p>
          {%- trans trimmed -%}
          For collaborations, freelance work, or just to say hi—reach out anytime.
          {%- endtrans -%}
        </p>

        <div class="contact-buttons">
          <ul>
            <li>
              <a class="contrast outline" href="#" target="_blank" rel="noopener">💬 {{ _("Telegram") }}</a>
            </li>
            <li>
              <a class="contrast outline" href="https://github.com/MykolaPrague" target="_blank" rel="noopener">🧑‍💻 {{ _("GitHub") }}</a>
            </li>
            <li>
              <a class="contrast outline" href="https://www.upwork.com/freelancers/~01d4779350a70aa648" target="_blank" rel="noopener">🧰 {{ _("Upwork") }}</a>
            </li>
          </ul>
        </div>

        <div id="flash-zone">
          {% with messages = get_flashed_messages(with_categories=true) %}
            {% for category, text in messages %}
              <article class="{{ 'success' if category=='success' else 'secondary' }} flash-msg" role="alert">
                {{ text }}
                <button class="close" aria-label="Close">&times;</button>
              </article>
            {% endfor %}
          {% endwith %}
        </div>
        <!-- CONTACT -->
        <section id="contact" class="panel fullvh" aria-labelledby="contact-title">
          <h2 id="contact-title">Contacts</h2>

          <p>
            For collaborations, freelance work, or just to say hi —
            please reach out via <strong>Upwork</strong> or <strong>GitHub</strong> below.
          </p>

          <div class="contact-buttons">
            <ul>
              <li>
                <a class="contrast outline" href="#" target="_blank" rel="noopener">💬 Telegram</a>
              </li>
              <li>
                <a class="contrast outline" href="https://github.com/MykolaPrague" target="_blank" rel="noopener">🧑‍💻 GitHub</a>
              </li>
              <li>
                <a class="contrast outline" href="https://www.upwork.com/freelancers/~01d4779350a70aa648" target="_blank" rel="noopener">
                  🧰 Upwork
                </a>
              </li>
            </ul>
          </div>
        {% comment %} <section id="contact-form-section" class="container">
          <h2>{{ _("Contact") }}</h2>
          <form action="/contact?lang={{ current_locale }}" method="post">
            <input type="hidden" name="lang" value="{{ current_locale }}">
            <label>{{ _("Name") }}<input type="text" name="name" required /></label>
            <label>{{ _("Email") }}<input type="email" name="email" required /></label>
            <label>{{ _("Message") }}<textarea name="message" rows="5" required></textarea></label>
            <label class="hp" aria-hidden="true" tabindex="-1">{{ _("Your website (leave empty)") }}<input type="text" name="website" autocomplete="off"/></label>
            <button type="submit" class="contrast">{{ _("Send") }}</button>
          </form>
        </section> {% endcomment %}

        <p class="contact-meta">
          📍 {{ _("Prague, Czechia") }} · ⏱️ {{ _("Mon–Fri, 09:00–17:00 CET") }}
        </p>
      </section>
    </main>

    <!-- JS -->
    <script>
      // --- Active link on scroll, preserving ?lang ---
      (function () {
        const links = document.querySelectorAll("a[data-nav]");
        const map = new Map([...links].map(a => [a.getAttribute("href").slice(1), a]));
        const io = new IntersectionObserver((entries) => {
          entries.forEach((e) => {
            if (!e.isIntersecting) return;
            links.forEach(a => a.classList.remove("is-active"));
            const a = map.get(e.target.id);
            if (a) a.classList.add("is-active");

            // preserve path + search (?lang=..), change only hash
            const url = new URL(location.href);
            url.hash = e.target.id;
            history.replaceState(null, "", url.toString());
          });
        }, { rootMargin: "-40% 0px -55% 0px", threshold: [0, 0.25, 1] });
        document.querySelectorAll("section[id]").forEach(s => io.observe(s));
      })();

      // --- Language Switch ---
      (function () {
        const mapLabel = { uk: "UK", cs: "CS", en: "EN" };

        function getCurrentLang() {
          try { return "{{ current_locale or '' }}"; } catch (e) {}
          const p = new URLSearchParams(location.search);
          return p.get("lang") || "en";
        }
        const currentLang = getCurrentLang() || "en";

        function closeAll() {
          document.querySelectorAll(".lang-menu.show").forEach(m => m.classList.remove("show"));
          document.querySelectorAll('.lang-btn[aria-expanded="true"]').forEach(b => b.setAttribute("aria-expanded","false"));
        }

        document.querySelectorAll(".lang-switch").forEach(sw => {
          const btn = sw.querySelector(".lang-btn");
          const menu = sw.querySelector(".lang-menu");
          const curEl = sw.querySelector(".lang-current");
          if (!btn || !menu || !curEl) return;

          curEl.textContent = mapLabel[currentLang] || currentLang.toUpperCase();

          menu.querySelectorAll("[data-lang]").forEach(a => {
            if (a.getAttribute("data-lang") === currentLang) a.classList.add("is-active");
          });

          function toggleMenu(show) {
            const willShow = (typeof show === "boolean") ? show : !menu.classList.contains("show");
            closeAll();
            if (willShow) {
              menu.classList.add("show");
              btn.setAttribute("aria-expanded","true");
              (menu.querySelector(".is-active") || menu.querySelector("[data-lang]"))?.focus();
            } else {
              menu.classList.remove("show");
              btn.setAttribute("aria-expanded","false");
            }
          }

          btn.addEventListener("click", (e) => {
            e.preventDefault();
            toggleMenu();
          });

          menu.querySelectorAll("[data-lang]").forEach(a => {
            a.addEventListener("click", (e) => {
              e.preventDefault();
              const lang = a.getAttribute("data-lang");
              const url = new URL(location.href);
              // keep current hash, set language
              url.searchParams.set("lang", lang);
              if (location.hash) url.hash = location.hash;
              closeAll();
              location.href = url.toString();
            });
          });
        });

        document.addEventListener("click", (e) => {
          if (!e.target.closest(".lang-switch")) closeAll();
        });
        document.addEventListener("keydown", (e) => {
          if (e.key === "Escape") closeAll();
        });
      })();

      // --- Theme toggle (persisted) ---
      (function () {
        const root = document.documentElement;
        const saved = localStorage.getItem("theme");
        if (saved === "light" || saved === "dark") root.setAttribute("data-theme", saved);
        function toggleTheme() {
          const cur = root.getAttribute("data-theme") || "light";
          const next = (cur === "light" ? "dark" : "light");
          root.setAttribute("data-theme", next);
          localStorage.setItem("theme", next);
        }
        document.querySelectorAll('#themeToggle').forEach(b => b.addEventListener("click", toggleTheme));
      })();

      // --- Flash auto-hide ---
      setTimeout(() => {
        document.querySelectorAll(".flash-msg").forEach((el) => {
          el.classList.add("hide");
          setTimeout(() => el.remove(), 400);
        });
      }, 10000);

      // close button for flash
      document.addEventListener("click", (e) => {
        const btn = e.target.closest(".flash-msg .close");
        if (!btn) return;
        const box = btn.closest(".flash-msg");
        box.classList.add("hide");
        setTimeout(() => box.remove(), 350);
      });

      // Ensure scroll to #contact if present
      if (location.hash === "#contact") {
        const el = document.getElementById("contact");
        if (el) {
          document.documentElement.classList.add('no-smooth');
          el.scrollIntoView({ behavior: 'auto', block: 'start' });
          setTimeout(() => document.documentElement.classList.remove('no-smooth'), 50);
        }
      }
    </script>
  </body>
</html>
